
# 5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения.

## Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

**Ответ**:

#### Виртуализация

> Это создание изолированных окружений в рамках одного физического устройства. 
> Каждое окружение имеет свой CPU, RAM, STORAGE, NETWORK. Эти окружения называются виртуальной машиной.

> Программное обеспечение которое управляет этими виртуальными машинами называется гипервизор.
> Оно обеспечивает параллельное выполнение операционных систем на одном сервере, эмулирует аппаратные ресурсы,
> отвечает за безопасность, исключает перехват и анализ команд гостевыми операционными системами. 

> Гипервизоры первого типа создают виртуальные машины на аппаратном уровне, т.е. он устанавливается на 
> голое железо как операционная система, с функциями загрузки самого себя, создания виртуальных окружений и управления 
> ими.

> Виртуальные машины первого типа полностью аппаратные, изолированные и управляемые гипервизором напрямую.

> **Примеры**: VMWare vSphere(VMware ESXi), Citrix Hypervisor(Xen Server), Microsoft Hyper-V


#### Паравиртуализация

> При паравиртуализации, в отличии от аппаратной виртуализации есть дополнительный слой в виде хостовой операционной системы,
> на ней устанавливается гипервизор.

> Для того чтобы создать виртуальную машину гипервизору нужно модифицировать ядро операционной системы.
> Это возможно только если код операционной системы открыт. Гостевые операционные системы подготавливаются для работы 
> в виртуальной среде, они взаимодействует с API гипервизора и не использует память напрямую, код касающийся 
> виртуализации находится в самой гостевой ОС.

> Приставка "пара" - ничего не значит. Просто создателям нужно были придумать новый термин.

> **Примеры**: VirtualBox, ProxMox, KVM 

#### Виртуализации на основе ОС

> Виртуализация уровня OS позволяет запускать изолированные виртуалки на одном хосте. 
> При такой виртуализации сама хостовая операционная система поддерживает несколько изолированных
> пространств(контейнеров).
> Ядро гостевой виртуальной машины должно быть таким же как ядро хостовой машины.

> Отличительной особенностью виртуализации на основне ОС является то что виртуализируется не компьютер, а окружение ОС.

> Слоя гипервизора нет, его роль выполняет хостовая операционная система.

> **Примеры**: LXC, OpenVZ, Docker


## Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:
- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:
- Высоконагруженная база данных, чувствительная к отказу.
- Различные web-приложения.
- Windows системы для использования бухгалтерским отделом.
- Системы, выполняющие высокопроизводительные расчеты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

**Ответ**:

> Очень странно что нет пункты с аппаратными виртуальными машинами(они относятся к уровню физических серверов?).

#### Высоконагруженная база данных, чувствительная к отказу.

> Мне кажется, что для этих целей лучше всего подходит физический сервер для того чтобы не было соседей, 
> которые могут "страдать" во время высоких нагрузок(обработка запросов) на базу данных.

> Для того, чтобы обеспечить отказоустройчивость для базы данных я бы использовал механизмы репликации.

#### Различные web-приложения.

> Я бы использовал виртуализацию уровня ОС. Для web-приложений сейчас в основном используют контейнеризацию через docker.
> При чем сам докер или kubernetes(для уже чего-то более серьезного) будет установлен на виртуальной машине.

> Зачастую в web-приложениях нет необходимости в большом потреблении CPU. Я немного разовью эту тему:
> 1. Для современного frontend-приложения нам нужен сервер, чтобы отдавать статику. Это относительно недорого в плане ресурсов.
> 2. При этом запросы за данными он будет отправлять на backend-сервер. Тут уже будет что-то типа Java, Go, Python, PHP etc.
> 3. Backend-сервера для web уже могут выполнять более сложные вычислительные задачи, но обычно они идут в базу данных или отправляют задачи в очередь и что-то другое их выполняет. 
> 4. Для базы данных или backend-серверов для каких-то сложных вычислительных задач можно использовать другой тип сервера.

Как-то так =)

Материалы которые мне помогли, кроме моего опыта:
1. [Архитектура Web Приложений / от простых до высоконагруженных](https://www.youtube.com/watch?v=9mZmc6a0tmM)

#### Windows системы для использования бухгалтерским отделом.

> Я бы выбрал физический сервер. Я думаю предполагается использование 1С? 
> Не знаю почему именно, но они сами, вроде, рекомендуют использовать именно физический сервер.
> Возможно, для 1С можно также использовать мощные виртуальные машины.

> Еще одна из причин использовать физического сервера и желательно в собственной стойке это **безопасность**,
> 1С предполагает использование огромного количества **персональных данных** и другой **коммерческой информации**.

Материалы которые мне помогли: 
1. [Как выбрать сервер для 1С?](https://server-shop.ua/how-to-choose-a-server-for-1c.html)

#### Системы, выполняющие высокопроизводительные расчеты на GPU.

> Я бы использовал для этих целей паравиртуализацию или даже виртуализацию уровня ОС.
> Поскольку согласно условию для выполнения расчетов нам нужен только GPU, думаю на уровне виртуализации можно
> выделить графический процессор и выполнять поставленную задачу, это не должно мешать соседям.


## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

**Ответ**:

Сценарии:

#### 1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
> Hyper-V

#### 2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
> Xen HVM

#### 3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
> Xen PV

#### 4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.
> KVM

## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

**Ответ**:

> Мне кажется, чтобы ответить на этот вопрос, необходимо иметь опыт работы хотя бы с системами виртуализации и желательно с гетерогенной средой виртуализации.
> Учитывая что мы даже не рассматривали эту тему на вебинаре мой ответ будет **взят из воздуха**. 
> Даже загуглив ответ на этот вопрос, без практики, на мой взгляд, смысла в этом задании нет.

> Если у меня нет на это строгой необходимости я бы **не стал** использовать гетерогенную среду виртуализации из-за следующих возможных проблем.
> В гетерогенной среде:
> 1. сократятся возможности автоматического распределения вычислительных ресурсов.
> 2. необходимо использовать несколько систем мониторинга от тех систем виртуализации из которых состоит гетерогенная среда, это снижает оперативность оценки состояния всей системы.
> 3. последствия ошибок из-за неверного распределения ресурсов в гетерогенной среде более критичны.

> Для того чтобы минимизировать риск вышеописанных проблем в гетерогенных средах используются программные системы которые заточены под это:
> 1. Tivoli Monitoring от фирмы IBM 
> 2. System Center от Microsoft
> 3. Veam One от фирмы Veam Software


Материалы которые мне помогли: 
1. [СИСТЕМНЫЙ АНАЛИЗ ДОСТУПНОСТИ РЕСУРСОВ ИНФОРМАЦИОННЫХ СИСТЕМ В ГЕТЕРОГЕННОЙ ВИРТУАЛЬНОЙ СРЕДЕ](http://www.info-secur.ru/old/is_12/tyshenko.pdf)
